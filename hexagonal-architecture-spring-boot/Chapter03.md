# 3장. 코드 구성하기
이번 장에서는 상대방에게 돈을 송금할 수 있는 ‘송금하기’ 유스케이스를  통해  육각형 아키텍처를 직접적으로 반영하는 **패키지 구조**를 알아보자

## 계층으로 구성하기
![](Chapter03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-05-06%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%2010.51.05.png)

* 웹 계층 : web 패키지 
* 도메인 계층 : domain 패키지
* 영속성 계층 : persistence 패키지

계층으로 패키지를 구성하는 방법은 최적의 구조가 아니다.

* 애플리케이션에 어떤 기능들이 있는지 쉽게 파악할 수가 없다.
* 만약 회원 관리 기능이 추가되면 서로 연관되지 않는 클래스들이 하나의 패키지에 위치하게 된다.

## 기능으로 구성하기
![](Chapter03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-05-06%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%2010.59.37.png)

**계좌** 와 관련된 모든 코드를 account 패키지에 몰았다.

package-private 접근 수준을 써서 계좌와 관련된 기능을 account 패키지 안에 꼭꼭 숨길 수 있다.
회원 관리 기능은 user 패키지 안에 작성하면 된다.

하지만 기능으로 구성하는 패키지는 **아키텍처의 가시성을 떨어뜨린다.**
-> 어떤 기능이 있는지는 쉽게 파악이 되지만, 프로젝트가 어떤 아키텍처로 구성되어 있는지 파악할 수 없다.


## 아키텍처적으로 표현력 있는 패키지 구조
![](Chapter03/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-05-06%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%2011.23.23.png)


아키텍처에서 구조적으로 핵심적인 요소들
* 도메인 엔티티
* 유스케이스
* 인커밍/아웃커밍 포트,
* 어댑터
을 패키지로 구성했다.

* 이 패키지 구조는 아키텍처-코드 갭 (architecture-code gap) 을 효과적으로 다룰 수 있다.
* 만약 패키지 구조가 아키텍처를 반영할 수 없다면, 시간이 점점 지남에 따라 코드는 목표하던 아키텍처로부터 멀어지게 된다.
* package-private 접근 수준을 사용해서 육각형 내부 (application)  에서 외부 (adapter) 를 의존하는 불상사도 막을 수 있다.
* DDD (도메인 주도 설계) 개념에 직접적으로 대응 가능하다. (Account bounded context)

## 의존성 주입
클린 아키텍처의 본질은 애플리케이션 (코어) 계층이 어댑터 (외부) 에 의존성을 갖지 않는 것이다.
**의존성 주입을 활용해서 인커밍 / 아웃고잉 어댑터 (주로 영속성 코드) 가 애플리케이션에 의존하게 할 수 있다.**

## 정리
* 아키텍처를 잘 표현할 수 있는 패키지 구조는 의사소통, 유지보수, 개발에 도움을 준다.
* 의존성 주입 등을 활용해서 애플리케이션의 코어 로직이 외부 (UI, DB) 에 의존하지 않게 할 수 있다.











#책정리/만들면서_배우는_클린아키텍쳐